---
bibliography: references.bib
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(scan)
library(scplot)
```

## scplot examples

Starting with `scan` version 0.53 we introduced the new plotting function `scplot`. This function will gradually replace the `plot.scdf()` (short: `plot()`) function. `scplot()` was designed to encompass a pipe style coding. For now, `scan` imports the `%>%` pipe operator from the `magrittr` package and exports it to the user namespace after executing `library(scan)`. Recently, with version 4.1, R implemented a pipe operator `|>` which also works fine with `scplot`.

`scplot` is already much more versatile then `plot.scdf` has been. But we will keep `plot.scdf` as it is in new upgrades of `scan`. We consider the state of `scplot` to be *experimental*. That is, the code and syntax might change in future versions so backward compatibility is not guaranteed.

Here are a few plots that have been generated with `scplot` to demonstrate its possibilities.

### The standard style with an added statline

```{r}
scplot(exampleAB) %>%
  add_statline("mean", color = "darkred") %>%
  set_ylabel(angle = 0)

```

### A simple style with axis settings

```{r}
scplot(exampleA1B1A2B2) %>% 
  add_theme("default", "small") %>% 
  set_xaxis(increment = 5, increment_from = 0) %>%
  set_panel(fill = c("grey90", "grey80")) %>%
  set_yaxis(limits = c(NA, 50)) %>%
  set_ylabel(angle = 0) %>%
  add_grid(color = "grey")
```

### A dark style for presentations

```{r}
scplot(exampleABC) %>% 
  set_xaxis(increment = 2) %>%
  add_labels(color = "black", box = "grey98", size = 2, nudge_y = 17) %>%
  set_yaxis(limits = c(30, 120)) %>%
  add_theme("phase_color")
 
```

### Rotated axis values, removed dots, and some adjustments on phasenames

```{r}
scplot(example_A24) %>% 
  add_statline("movingMean", col = "darkred") %>%
  set_xaxis(size = 10, angle = 35) %>%
  set_dataline(size = 0) %>%
  add_legend(x = 2010, y = 250) %>%
  set_phasenames("no speedlimit", "with speedlimit", x = "centre", y = "top", 
                 size = 3, box = "white") %>%
  set_casenames("") %>%
  add_title("Effect of a speedlimit on the A24") %>%
  add_grid(color = "white", size = 0.3, linetype = "solid") %>%
  add_caption("Note: Moving mean calculated with lag two.", size = 10, face = 3)
  
```

### The chart theme

```{r}
scplot(exampleA1B1A2B2_zvt) %>% 
  add_theme("chart") %>%
  set_yaxis(limits = c(40, 90))
```

### Mulitple variables in a plot with an added legend

```{r}
scplot(exampleAB_add) %>%
  add_dataline("depression", color = "darkred") %>% 
  add_dataline("cigarrets", color = "lightblue") %>%
  add_statline("trend", linetype = "dashed") %>%
  add_statline("mean", variable = "depression", color = "red") %>%
  add_marks(case = 1, positions = c(14,20), size = 3, variable = "cigarrets")%>%
  add_marks(case = 1, positions = "cigarrets > quantile(cigarrets, 0.75)", size = 3)%>%
  set_xaxis(increment = 5) %>%
  set_phasenames(x = "left", hjust = 0) %>%
  set_casenames(y = 40, x = 35, size = 6, color = "darkred") %>%
  add_legend(x = 30, y = 45) %>%
  add_theme("phase_color")


```

### An entensive example to show-off

```{r}
scplot(exampleA1B1A2B2) %>% 
  set_xaxis(increment = 4, size = 4, color = "brown") %>%
  set_yaxis(color = "sienna3", size = 4) %>%
  set_ylabel("Points", color = "sienna3", size = 7, angle = 0) %>%
  set_xlabel("Weeks", size = 7, color = "brown") %>%
  add_title("Points by week", color = "sienna4", size = 12, face = 3) %>%
  add_caption("Note: An extensive Example.", 
              color = "black", size = 7, face = 3) %>%
  set_phasenames("Baseline", "Intervention", "Fall-Back", "Intervention_2", 
                 color = "darkgreen") %>%
  add_ridge(alpha("lightblue", 0.5)) %>%
  set_casenames(sample_names(3), color = "steelblue4", size = 3) %>%
  set_panel(fill = c("grey80", "grey95"), color = "sienna4", alpha = 0.5) %>%
  add_grid(color = "grey85", size = 0.5) %>%
  set_dataline(color = "black", width = 1, linetype = "solid", 
               dots = "sienna4", size = 1, shape = 18) %>%
  add_labels(color = "sienna", size = 0.5) %>%
  set_seperator(extent = 0.8, width = 0.5, 
                linetype = "solid", color = "sienna") %>%
  add_statline(stat = "trendA", color = "tomato2") %>%
  add_statline(stat = "maxA", color = "lightblue") %>%
  add_marks(case = 1:2, positions = 14, color = "red3", size = 2, shape = 4) %>%
  add_marks(case = "all", positions = "values < quantile(values, 0.1)", 
            color = "blue3", size = 1.5) %>%
  add_marks(positions = outlier(exampleABAB), color = "brown", size = 2) %>%
  add_text(case = 1, x = 5, y = 35, label = "Interesting", 
           color = "darkgreen", angle = 20, size = 3) %>%
  add_arrow(case = 1, 5, 30, 5, 22, color = "steelblue") %>%
  set_background(fill = "sienna1") %>%
  add_legend(case = 2, title = "Legend") %>%
  set_theme_element(legend.text.size = 0.5)

```
